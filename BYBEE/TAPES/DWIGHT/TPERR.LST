

2000                     0000 ; 2710 LAST LINE
2000                     0010 SRA4	EQU	0C16H
2000                     0020 WH0	EQU	0C20H
2000                     0030 WH1	EQU	0C24H
2000                     0040 WH2	EQU	0C28H
2000                     0050 FNAME	EQU	0C54H
2000                     0060 RNAME	EQU	0C5CH
2000                     0070 RRN	EQU	0C64H
2000                     0080 RLEN	EQU	0C66H
2000                     0090 RADR	EQU	0C67H
2000                     0100 RTYPE	EQU	0C69H
2000                     0110 IORET	EQU	064H
2000                     0120 DSPLY	EQU	007FH
2000                     0130 MOVE	EQU	0100H
2000                     0140 FLDSY	EQU	017CH
2000                     0150 GET	EQU	029AH
2000                     0160 SETUP	EQU	02ADH
2000                     0170 CROUT	EQU	038DH
2000                     0180 CLEAR	EQU	0392H
2000                     0190 BLK	EQU	0397H
2000                     0200 LCFLD	EQU	03A1H
2000                     0210 DEOUT	EQU	03D1H
2000                     0220 BYTE	EQU	03D6H
2000                     0230 INITR	EQU	03EAH
2000                     0240 ;  ORG 2000H
2000 CD 92 03            0250 TAPE	CALL	CLEAR
2003 21 00 23            0260 START	LXI	H,FBUF
2006 22 F5 21            0270		SHLD	PFBUF
2009 CD A1 03            0280 START1	CALL	LCFLD
200C CD 76 20            0290		CALL	FTYPE
200F CA 15 20            0300		JZ	NAMX
2012 C3 03 20            0310		JMP	START
2015 CD 93 20            0320 NAMX	CALL	NAMER
2018 21 B8 20            0330 HEAD	LXI	H,DNAME
201B E5                  0340		PUSH	H
201C 3E 96               0350 HEAD6	MVI	A,096H
201E D3 01               0360		OUT	1
2020 CD 28 0C            0370		CALL	WH2
2023 FE E6               0380 HEAD7	CPI	0E6H
2025 C2 1C 20            0390		JNZ	HEAD6
2028 CD 28 0C            0400		CALL	WH2
202B FE 01               0410		CPI	001H
202D C2 23 20            0420		JNZ	HEAD7
2030 21 5C 0C            0430		LXI	H,RNAME
2033 0E 0E               0440		MVI	C,0EH
2035 CD 9A 02            0450		CALL	GET
2038 C2 F8 20            0460		JNZ	ERROR
203B 21 5C 0C            0470		LXI	H,RNAME
203E 11 54 0C            0480		LXI	D,FNAME
2041 0E 08               0490		MVI	C,8
2043 1A                  0500 COMP	LDAX	D
2044 BE                  0510		CMP	M
2045 C0                  0520		RNZ
2046 13                  0530		INX	D
2047 23                  0540		INX	H
2048 0D                  0550		DCR	C
2049 C2 43 20            0560		JNZ	COMP
204C 2A F5 21            0570		LHLD	PFBUF
204F EB                  0580		XCHG
2050 21 5C 0C            0590		LXI	H,RNAME
2053 01 F2 FF            0600		LXI	B,-0EH
2056 CD 00 01            0610		CALL	MOVE
2059 EB                  0620		XCHG
205A 22 F5 21            0630		SHLD	PFBUF
205D 3A 66 0C            0640		LDA	RLEN
2060 4F                  0650		MOV	C,A
2061 3A 69 0C            0660		LDA	RTYPE
2064 FE 02               0670		CPI	2
2066 CA 01 21            0680		JZ	WRFILE
2069 FE 03               0690		CPI	3
206B CA 01 21            0700		JZ	WRFILE
206E FE 06               0710		CPI	6
2070 CA 01 21            0720		JZ	WRFILE
2073 C3 F1 20            0730		JMP	GETD
2076                     0740 ;
2076 4F                  0750 FTYPE	MOV	C,A
2077 FE 42               0760		CPI	'B'
2079 CA 8A 20            0770		JZ	BITE
207C FE 50               0780		CPI	'P'
207E C0                  0790		RNZ
207F CD AD 02            0800 POLY	CALL	SETUP
2082 05                  0810		DB	05H
2083 AA                  0820		DB	0AAH
2084 40                  0830		DB	040H
2085 0C                  0840		DB	0CH
2086 E6                  0850		DB	0E6H
2087 E6                  0860		DB	0E6H
2088 00                  0870		DB	0
2089 C9                  0880		RET
208A CD AD 02            0890 BITE	CALL	SETUP
208D 06                  0900		DB	06H
208E AA                  0910		DB	0AAH
208F 40                  0920		DB	040H
2090 CE                  0930		DB	0CEH
2091 00                  0940		DB	0H
2092 C9                  0950		RET
2093                     0960 ;
2093 21 54 0C            0970 NAMER	LXI	H,FNAME
2096 79                  0980		MOV	A,C
2097 CD 24 0C            0990		CALL	WH1
209A CD 8D 03            1000		CALL	CROUT
209D 0E 09               1010		MVI	C,9
209F CD 20 0C            1020 NAM0	CALL	WH0
20A2 CD 24 0C            1030		CALL	WH1
20A5 FE 0D               1040		CPI	0DH
20A7 CA B0 20            1050		JZ	NAM
20AA 77                  1060		MOV	M,A
20AB 23                  1070		INX	H
20AC 0D                  1080		DCR	C
20AD C2 9F 20            1090		JNZ	NAM0
20B0 36 20               1100 NAM	MVI	M,20H
20B2 23                  1110		INX	H
20B3 0D                  1120		DCR	C
20B4 F2 B0 20            1130		JP	NAM
20B7 C9                  1140		RET
20B8                     1150 ;
20B8 01 5C 0C            1160 DNAME	LXI	B,RNAME
20BB 16 08               1170		MVI	D,8
20BD 37                  1180 DNAM2	STC
20BE CD 7C 01            1190		CALL	FLDSY
20C1 15                  1200		DCR	D
20C2 C2 BD 20            1210		JNZ	DNAM2
20C5 CD 97 03            1220		CALL	BLK
20C8 2A 64 0C            1230		LHLD	RRN
20CB EB                  1240		XCHG
20CC CD D1 03            1250		CALL	DEOUT
20CF CD 97 03            1260		CALL	BLK
20D2 3A 66 0C            1270		LDA	RLEN
20D5 CD D6 03            1280		CALL	BYTE
20D8 CD 97 03            1290		CALL	BLK
20DB 2A 67 0C            1300		LHLD	RADR
20DE EB                  1310		XCHG
20DF CD D1 03            1320		CALL	DEOUT
20E2 CD 97 03            1330		CALL	BLK
20E5 3A 69 0C            1340		LDA	RTYPE
20E8 CD D6 03            1350		CALL	BYTE
20EB CD 8D 03            1360		CALL	CROUT
20EE C3 18 20            1370		JMP	HEAD
20F1                     1380 ;
20F1 CD 9A 02            1390 GETD	CALL	GET
20F4 22 F5 21            1400		SHLD	PFBUF
20F7 C8                  1410		RZ
20F8 3E 3F               1420 ERROR	MVI	A,'?'
20FA CD 7F 00            1430		CALL	DSPLY
20FD CD 8D 03            1440		CALL	CROUT
2100 C9                  1450		RET
2101                     1460 ;
2101 E1                  1470 WRFILE	POP	H
2102 21 E7 21            1480		LXI	H,TISR
2105 22 16 0C            1490		SHLD	SRA4
2108 AF                  1500 WR2	XRA	A
2109 D3 01               1510		OUT	1
210B CD 8D 03            1520		CALL	CROUT
210E CD 8D 03            1530		CALL	CROUT
2111 21 00 23            1540		LXI	H,FBUF
2114 22 F5 21            1550		SHLD	PFBUF
2117 CD A1 03            1560 WR1	CALL	LCFLD
211A CD 76 20            1570		CALL	FTYPE
211D C2 17 21            1580		JNZ	WR1
2120 79                  1590		MOV	A,C
2121 CD 24 0C            1600		CALL	WH1
2124 CD 8D 03            1610		CALL	CROUT
2127 CD 20 0C            1620 WR3	CALL	WH0
212A CD 24 0C            1630		CALL	WH1
212D FE 0D               1640		CPI	0DH
212F C2 27 21            1650		JNZ	WR3
2132 CD 8D 03            1660		CALL	CROUT
2135 CD 41 21            1670		CALL	DUMP
2138 2A EA 03            1680		LHLD	INITR
213B 22 16 0C            1690		SHLD	SRA4
213E C3 03 20            1700		JMP	START
2141                     1710 ;
2141 3E 21               1720 DUMP	MVI	A,021H
2143 D3 01               1730		OUT	1
2145 2A F5 21            1740 DUMP1	LHLD	PFBUF
2148 44                  1750		MOV	B,H
2149 4D                  1760		MOV	C,L
214A 16 08               1770		MVI	D,8
214C 37                  1780 DUMP2	STC
214D CD 7C 01            1790		CALL	FLDSY
2150 15                  1800		DCR	D
2151 C2 4C 21            1810		JNZ	DUMP2
2154 CD 97 03            1820		CALL	BLK
2157 0A                  1830		LDAX	B
2158 5F                  1840		MOV	E,A
2159 03                  1850		INX	B
215A 0A                  1860		LDAX	B
215B 57                  1870		MOV	D,A
215C CD D1 03            1880		CALL	DEOUT
215F CD 8D 03            1890		CALL	CROUT
2162 21 FF 8F            1900		LXI	H,08FFFH
2165 2B                  1910 DELAY	DCX	H
2166 7C                  1920		MOV	A,H
2167 B7                  1930		ORA	A
2168 C2 65 21            1940		JNZ	DELAY
216B 0E 40               1950		MVI	C,64
216D 3E E6               1960		MVI	A,0E6H
216F CD D6 21            1970 DUMP0	CALL	TO
2172 0D                  1980		DCR	C
2173 C2 6F 21            1990		JNZ	DUMP0
2176 3E 01               2000		MVI	A,1
2178 CD D6 21            2010		CALL	TO
217B 3E 0E               2020		MVI	A,0EH
217D 2A F5 21            2030		LHLD	PFBUF
2180 CD C1 21            2040		CALL	PUT
2183 22 F5 21            2050		SHLD	PFBUF
2186 2B                  2060		DCX	H
2187 7E                  2070		MOV	A,M
2188 FE 02               2080		CPI	2
218A CA B1 21            2090		JZ	DEND
218D FE 03               2100		CPI	3
218F CA B1 21            2110		JZ	DEND
2192 FE 06               2120		CPI	6
2194 CA B1 21            2130		JZ	DEND
2197 2B                  2140		DCX	H
2198 2B                  2150		DCX	H
2199 2B                  2160		DCX	H
219A 7E                  2170		MOV	A,M
219B 2A F5 21            2180		LHLD	PFBUF
219E CD C1 21            2190		CALL	PUT
21A1 22 F5 21            2200		SHLD	PFBUF
21A4 AF                  2210		XRA	A
21A5 CD D6 21            2220		CALL	TO
21A8 CD D6 21            2230		CALL	TO
21AB CD D6 21            2240		CALL	TO
21AE C3 45 21            2250		JMP	DUMP1
21B1                     2260 ;
21B1 AF                  2270 DEND	XRA	A
21B2 CD D6 21            2280		CALL	TO
21B5 CD D6 21            2290		CALL	TO
21B8 CD D6 21            2300		CALL	TO
21BB D3 01               2310		OUT	1
21BD CD 8D 03            2320		CALL	CROUT
21C0 C9                  2330		RET
21C1                     2340 ;
21C1 06 00               2350 PUT	MVI	B,0
21C3 4F                  2360		MOV	C,A
21C4 7E                  2370 PUT0	MOV	A,M
21C5 23                  2380		INX	H
21C6 F5                  2390		PUSH P SW
21C7 80                  2400		ADD	B
21C8 47                  2410		MOV	B,A
21C9 F1                  2420		POP	P SW
21CA CD D6 21            2430		CALL	TO
21CD 0D                  2440		DCR	C
21CE C2 C4 21            2450		JNZ	PUT0
21D1 AF                  2460		XRA	A
21D2 90                  2470		SUB	B
21D3 C3 D6 21            2480		JMP	TO
21D6                     2490 ;
21D6 E5                  2500 TO	PUSH	H
21D7 21 F3 21            2510		LXI	H,TBUFF
21DA F5                  2520		PUSH	P SW
21DB 7E                  2530 TO1	MOV	A,M
21DC B7                  2540		ORA	A
21DD C2 DB 21            2550		JNZ	TO1
21E0 23                  2560		INX	H
21E1 F1                  2570		POP	P SW
21E2 77                  2580		MOV	M,A
21E3 2B                  2590		DCX	H
21E4 34                  2600		INR	M
21E5 E1                  2610		POP	H
21E6 C9                  2620		RET
21E7                     2630 ;
21E7 AF                  2640 TISR	XRA	A
21E8 32 F3 21            2650		STA	TBUFF
21EB 3A F4 21            2660		LDA	TBUFF+1
21EE D3 00               2670		OUT	0
21F0 C3 64 00            2680		JMP	IORET
21F3                     2690 TBUFF	DS	2
21F5                     2700 PFBUF	DS	2
21F7                     2710 FBUF	EQU	TAPE+0300H
>